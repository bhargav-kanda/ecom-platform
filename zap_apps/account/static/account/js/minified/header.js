function getSuggestedQuery(a){var b="";return a.Category.length&&(b+="&i_category="+a.Category[0].replace(/ /g,"-").toLowerCase()),a.Style.length&&(b+="&i_style="+a.Style[0].replace(/ /g,"-").toLowerCase()),a.Brand.length&&(b+="&i_brand="+a.Brand[0].replace(/ /g,"-").toLowerCase()),a.Color.length&&(b+="&i_color="+a.Color[0].replace(/ /g,"-").toLowerCase()),a.Occasion.length&&(b+="&i_occasion="+a.Occasion[0].replace(/ /g,"-").toLowerCase()),a.SubCategory.length&&(b+="&i_product_category="+a.SubCategory[0].replace(/ /g,"-").toLowerCase()),b}function cleverTapCheckout(a){clevertap.event.push("checkout_step",{cart_id:cart_id,step:a,value_of_cart:$("#total_pay").text()})}var zapyle=angular.module("zapyle",["ngStorage","ngSanitize"]);zapyle.config(function(a,b){b.startSymbol("[[").endSymbol("]]"),a.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}),zapyle.filter("spaceless",function(){return function(a){if(a)return a.replace(/\s+/g,"-")}}),zapyle.filter("spacetoplus",function(){return function(a){if(a)return a.replace(/\s+/g,"+")}}),zapyle.filter("spacetounderscore",function(){return function(a){if(a)return a.replace(/\s+/g,"_")}}),zapyle.directive("scrollTo",["ScrollTo",function(a){return{restrict:"AC",compile:function(){return function(b,c,d){c.bind("click",function(b){a.idOrName(d.scrollTo,d.offset)})}}}}]).service("ScrollTo",["$window","ngScrollToOptions",function(a,b){this.idOrName=function(c,d,e){var f=a.document;c||a.scrollTo(0,0),void 0===e&&(e=!0);var g=f.getElementById(c);g||(g=f.getElementsByName(c),g=g&&g.length?g[0]:null),g&&(e&&g.focus(),b.handler(g,d))}}]).provider("ngScrollToOptions",function(){this.options={handler:function(a,b){if(b){var c=$(a).offset().top-b;window.scrollTo(0,c)}else a.scrollIntoView()}},this.$get=function(){return this.options},this.extend=function(a){this.options=angular.extend(this.options,a)}}),zapyle.controller("HeaderController",["$scope","$http","$rootScope","$localStorage","admireService",function(a,b,c,e,f){function m(){$("#searchBox").addClass("listing_spinner"),a.search_suggestions()}function o(c){for(i in a.carts.items)b.get("/catalogue/offers/"+(a.carts.items[i].product_id||a.carts.items[i].product)).success(function(b){"success"==b.status&&(a.carts.items[i].offers=b.data)})}function t(c){var d={address_id:$(".address_item.selected").data("id"),apply_zapcash:a.zapcash_used};1==c&&(d.cod=!0),console.log(JSON.stringify(d)),a.order_id="juspay on processing",a.$$phase||a.$apply(),$(".payment_loader").addClass("is_visible"),b.post("/order/juspay_order",d).success(function(b){console.log(JSON.stringify(b)),"success"==b.status?($(".payment_loader").removeClass("is_visible"),"TXFWD"==b.data.message?(a.iframe_url=b.data.iframe,$("#iframe").html("<iframe src='"+b.data.iframe+"'></iframe>"),a.order_id=b.data.order_id,a.$$phase||a.$apply()):(window.history.pushState("","","/order/"+b.data.order_id),location.reload())):(Materialize.toast(b.detail,3e3),"Please add items to your cart. Cart is empty now."==b.detail&&(window.history.pushState("","","#rp_cart"),location.reload()))})}a.isMobile=isMobile,clevertap.event.push("page_change",{new_page:window.location.pathname,old_page:document.referrer.replace(/^[^:]+:\/\/[^\/]+/,"").replace(/#.*/,""),page_view_starttime:Date()}),a.FBLogin=function(){FB.login(function(c){if("connected"==c.status){var d=c.authResponse.accessToken;b({method:"POST",url:"/account/login/",data:{access_token:d,logged_from:"fb",logged_device:"website"}}).then(function(d){d.data.data.profile_completed>1&&e.tote&&e.tote.cart_data.length?b.post("/zapcart/",e.tote).success(function(b){"success"==b.status&&"continue with the purchase"==a.loginPurpose?(e.$reset(),window.history.pushState("","","#rp_checkout"),location.reload()):location.reload()}):setTimeout(function(){clevertap.profile.push({Facebook:d.data}),window.history.pushState("","","#rp_my_profile"),location.reload()})})}else alert("facebook login error")},{scope:"public_profile,email"})},a.my_profile=function(){b.get("/user/myinfo/?web=true").success(function(c,d,f,g){if("success"==c.status){if(a.user=c.data,a.user.zap_username){if($("#onboarding0").removeClass("is_hidden"),$("#onboarding1").addClass("is_hidden"),"Male"==a.user.gender)var h="M";else var h="F";clevertap.profile.push({Site:{Name:a.user.zap_username,Identity:USER_ID,email:a.user.email,Gender:h,Photo:a.user.profile_pic}})}else $("#onboarding1").removeClass("is_hidden"),$("#onboarding0").addClass("is_hidden");angular.copy(c.data,a.user1),e.tote&&e.tote.cart_data.length&&b.post("/zapcart/",e.tote).success(function(a){"success"==a.status&&e.$reset()})}})},"True"!=ZL&&e.tote&&e.tote.cart_data.length&&$("#toteBadge").text(e.tote.cart_data.length);var g=$(".datepicker").pickadate({selectMonths:!0,selectYears:100}),h=g.pickadate("picker");a.my_info=function(){b.get("/user/myinfo/").success(function(b,c,d,e){"success"==b.status&&(a.user=b.data,h.set("select",a.user.dob,{format:"dd-mm-yyyy"}),a.user.selected_location_id&&(a.user.selected_location_id=a.user.selected_location_id.toString()),setTimeout(function(){$("select").material_select()}))})},a.submitDescription=function(c){b.put("/user/myinfo/",{description:c}).success(function(b){"success"==b.status&&(a.user.description=c,c="")})},a.updateErrors={},a.update_myinfo=function(c){if(a.updateErrors={},data={},$("#female").hasClass("is_selected"))data.gender="F";else{if(!$("#male").hasClass("is_selected"))return a.updateErrors.gender="Select Gender",!1;data.gender="M"}c.dob=h.get("select","dd-mm-yyyy"),c.dob&&(data.dob=c.dob),c.selected_location_id&&(data.selected_location_id=c.selected_location_id),data.description=c.description,c.full_name&&(data.full_name=c.full_name),b.put("/user/myinfo/",data).success(function(b){if("success"==b.status)a.my_profile(),history.pushState("","","#rp_my_profile"),$("#my_profile").addClass("is_visible"),$("#my_info").removeClass("is_visible"),a.desc="";else{var c=b.detail;"zap_username"in c&&(a.updateErrors.zap_username=c.zap_username),"description"in c&&(a.updateErrors.description=c.description[0]),"gender"in c&&(a.updateErrors.gender=c.gender[0]),"selected_location_id"in c&&(a.updateErrors.state=c.selected_location_id[0])}})},a.my_account=function(){},a.my_preferences=function(){},a.my_interests=function(){b.get("/user/mybrandtags/").success(function(b,c,d,e){"success"==b.status&&(a.mybrandtags=b.data)}),b.get("/onboarding/2?end=34").success(function(b,c,d,e){"success"==b.status&&(a.allbrandtags=b.data)})},$("body").on("click",".tag_item",function(){$(this).toggleClass("selected");var a=$(".tag_item.selected").map(function(){return $(this).data("id")}).get();b.post("/onboarding/2",{btags_selected:a})}),a.my_sizes=function(){b.get("/user/mysizes").success(function(b,c,d,e){"success"==b.status&&(a.mysize=b.data[0].size,a.waist_size=b.data[0].waist_size,a.foot_size=b.data[0].foot_size)}),b.get("/onboarding/4").success(function(b,c,d,e){"success"==b.status&&(a.allsize=b.data)})},a.checkValue1=function(b){for(var c in a.mysize)if(a.mysize[c].id===b.id)return!0;return!1},a.checkValue2=function(b){for(var c in a.foot_size)if(a.foot_size[c].id===b.id)return!0;return!1},a.checkValue3=function(b){for(var c in a.waist_size)if(a.waist_size[c].id===b.id)return!0;return!1},$("body").on("click",".size_item1",function(){$(this).toggleClass("selected");var a=$(".size_item.waist_sizes.selected").map(function(){return $(this).data("id")}).get(),c=$(".size_item.foot_sizes.selected").map(function(){return $(this).data("id")}).get(),d=$(".size_item.cloth_sizes.selected").map(function(){return $(this).data("id")}).get();b.post("/onboarding/4",{waist_sizes:a,foot_sizes:c,cloth_sizes:d})}),a.my_brands=function(){b.get("/user/mybrands?end=300").success(function(b,c,d,e){"success"==b.status&&(a.brands=b.data)})},$("body").on("click",".follow",function(){$(this).toggleClass("selected");var a=$(".follow.selected").map(function(){return $(this).data("id")}).get();b.post("/onboarding/3",{brands_selected:a})}),a.add_adrss_btn_text="Add Address",c.my_addresses=function(c){b.get("/address/crud/").success(function(b,d,e,f){"success"==b.status&&(a.addrs=b.data,setTimeout(function(){if(void 0!=c){$(".address_item[data-id = "+c+"]").addClass("selected");var a=$(".address_item[data-id = "+c+"]");$(".address").text(a.find(".name .namee").text()+" - "+a.find(".name .phone").text())}}))})},a.add_address=function(c){a.add_adrss_btn_text="Add Address",a.a={},a.errors={},b.get("/address/get_states/").success(function(b,c,d,e){"success"==b.status&&(a.states=b.data,setTimeout(function(){$("select").material_select()}))}),1==c&&(e.backto_checkout=!0)},a.edit_address=function(c){a.add_adrss_btn_text="Update Address",a.errors={},a.a=c,b.get("/address/get_states/").success(function(b,d,e,f){"success"==b.status&&(a.states=b.data,setTimeout(function(){$("select").material_select(),a.pincodeTyping(c.pincode)}))})},a.save_address=function(){a.errors={};var c=a.a;if(c.state=$("#state").val(),"Add Address"==a.add_adrss_btn_text)var d="POST";else{var d="PUT";c.address_id=c.id}b({method:d,url:"/address/crud/",data:c},console.log(a.new_pincode)).error(function(a){console.log(a)}).then(function(c){if(console.log(c),c.data.data)a.a={},e.backto_checkout?(a.my_addresses(c.data.data.id),history.pushState("","","#rp_checkout"),$("#checkout").addClass("is_visible"),$("#add_address").removeClass("is_visible"),e.backto_checkout=!1):(a.my_addresses(),history.pushState("","","#rp_my_addresses"),$(".right_panel_inner > div").removeClass("is_visible"),$("#my_addresses").addClass("is_visible"));else{var d=c.data.detail;"name"in d&&(a.errors.name=d.name[0]),"address"in d&&(a.errors.address=d.address[0]),"city"in d&&(a.errors.city=d.city[0]),"state"in d&&(a.errors.state=d.state[0]),"phone"in d&&(a.errors.phone=d.phone[0]),"pincode"in d&&(a.errors.pincode=d.pincode[0]),console.log(JSON.stringify(c.data.detail))}})},a.pincodeTyping=function(c){6==c.length&&b.get("/address/pincode/?pincode="+c).success(function(b){if("success"==b.status){d=b.data,a.a.city=d.city;for(i in a.states)a.states[i].name.toLowerCase()===d.state.toLowerCase()&&(a.selected_state=a.states[i].id.toString(),setTimeout(function(){$("select").material_select()}));clevertap.event.push("pincode_check",{pincode_checked:c})}})},a.my_notifications=function(){b.get("/notification/getmynotifs/").success(function(b,c,d,e){"success"==b.status&&(a.mynotif=b.data)})},a.readNotification=function(a){"comment"==a.action&&(e.showcomment=!0),b.post("/notification/readnotif",{notif_id:a.id})},a.my_wallet=function(){b.get("/extra/appvirality/campaign").success(function(b,c,d,e){"success"==b.status&&(a.mywallet=b.data,console.log(b.data))})},a.add_bank_account=function(){},a.bk={},a.save_bank_account=function(){a.errors={},b({method:"POST",url:"user/accountnumber/",data:{account_number:a.bk.user_acc,ifsc_code:a.bk.ifsc_code,account_holder:a.bk.account_holder}}).then(function(c){if("success"==c.data.status)a.my_bank_account(),$("[data-activates=#my_bank_account]").click(),history.pushState("","","#rp_my_bank_account");else{var d=c.data.detail;"account_holder"in d&&(a.errors.account_holder=d.account_holder[0]),"account_number"in d&&(a.errors.account_number=d.account_number[0]),"ifsc_code"in d&&(a.errors.ifsc_code=d.ifsc_code[0])}})},a.my_bank_account=function(){b.get("/user/accountnumber/").success(function(b,c,d,e){"success"==b.status&&(a.bankAC=b,console.log(b))})},c.my_orders=function(){b.get("/user/myorders/").success(function(b,c,d,e){"success"==b.status&&(a.myorders=b.data.data,console.log(b))})},a.order_details=function(c,d){if(!c)return $("[data-activates=#my_orders]").click(),$($("#order_details_page_back_btn").attr("data-activates")).addClass("is_visible"),setTimeout(function(){$("#order_details").removeClass("is_visible")}),history.pushState("","","#rp_my_orders"),a.my_orders(),!1;if(b.get("/order/details/"+c).success(function(b,d,e,f){"success"==b.status&&(a.currentOrder=c,a.order=b.data,a.order=b.data,a.order.rating?a.rating=parseInt(a.order.rating):a.rating=!1,console.log(b))}),"sale_page"==d){var e=$("#order_details_page_back_btn");e.attr("data-activates","#my_sales"),e.attr("href","#rp_my_sales")}else{var e=$("#order_details_page_back_btn");e.attr("data-activates","#my_orders"),e.attr("href","#rp_my_orders")}},a.my_sales=function(){b.get("/user/mysales/").success(function(b,c,d,e){"success"==b.status&&(a.mysales=b.data,console.log(b))})},a.setFocus=function(){setTimeout(function(){$("#search_box").focus()})},c.USER_ID=USER_ID,a.my_admiring=function(){b.put("/user/admire/",{user_id:USER_ID,admire_type:"admiring"}).success(function(b){a.admirings=b.data})},a.my_admirers=function(){b.put("/user/admire/",{user_id:USER_ID,admire_type:"admires"}).success(function(b){a.admirers=b.data})};var j,k=300,l=$("#search_box");l.on("keyup",function(){clearTimeout(j),j=setTimeout(m,k)}),l.on("keydown",function(){clearTimeout(j)});var n="product";a.search_suggestions=function(c){if(setTimeout(function(){$("#search_box").focus()}),"product"!=c&&"closet"!=c||(n=c),"product"==n&&a.use_suggestion_flag){if(a.search_key.substring(0,a.use_suggestion_string.length)===a.use_suggestion_string){var d=a.search_key.substring(a.use_suggestion_string.length);if(!d)return a.suggestions=[],a.$apply(),!1;a.search_use_suggestion(d)}else a.search_key="",a.use_suggestion_flag=!1,a.$apply();return!1}return a.search_key?void b({method:"POST",url:"/search/suggestions/"+n,data:{perpage:2,query_string:a.search_key,filter:{Category:[],Style:[],Color:[],Occasion:[],Brand:[],SubCategory:[],string:""}}}).then(function(c){"product"==n?a.pInit=!0:a.uInit=!0,a.suggestions=c.data.data,console.log(c)}):("product"==n?a.pInit=!1:a.uInit=!1,a.suggestions=[],a.$apply(),!1)},a.pInit=!1,a.uInit=!1,a.useSuggestion=function(b){a.search_key=b.string,setTimeout(function(){$("#search_box").focus()}),a.use_suggestion_flag=!0,a.use_suggestion_obj=b,a.use_suggestion_string=b.string.substring(0,b.string.length-1)},a.search_use_suggestion=function(c){c&&b({method:"POST",url:"/search/suggestions/product",data:{query_string:c,filter:a.use_suggestion_obj}}).then(function(c){a.suggestions=c.data.data})},String.prototype.rtrim=function(){return this.replace(/((\s*\S+)*)\s*/,"$1")},a.searchFilter=function(a){window.history.pushState("","","/buy?"+getSuggestedQuery(a)),location.reload()},a.search=function(){},a.searchSuggestion=function(b){if(a.use_suggestion_flag){var c=a.search_key.substring(a.use_suggestion_string.length+1);window.history.pushState("","","/buy?search="+c.replace(/ /g,"+")+getSuggestedQuery(a.use_suggestion_obj))}else window.history.pushState("","","/buy?search="+b.replace(/ /g,"+"));location.reload()},$("#search_box").keypress(function(b){"13"==b.which&&a.search_key&&a.searchSuggestion(a.search_key)}),a.cartLoader=!0,c.cart=function(){if(a.cartLoader=!0,a.cartTotalOffline=0,"True"==ZL)b.get("/zapcart/").success(function(b){"success"==b.status&&(a.carts=b.data,a.cartLoader=!1,o(a.carts))});else if(e.tote){var d=e.tote.cart_data;b.post("/zapcart/quantity_availablity/",d).success(function(b){a.carts=b.data,a.cartLoader=!1,o(a.carts)})}else a.cartLoader=!1},a.removeCartItem=function(b){return b.quantity_available>=b.product_quantity?(a.itemToRemove=b,$("#confirm_remove_item").addClass("is_visible"),!1):void a.removeSoldout(b)},a.removeSoldout=function(c){if(c||(c=a.itemToRemove,$("#confirm_remove_item").removeClass("is_visible")),"True"==ZL)b.delete("/zapcart/",{params:{item_id:c.id}}).success(function(b){"success"==b.status&&(a.carts=b.data,$(".cart_btn").removeClass("is_hidden"),$(".goto_btn").addClass("is_hidden"),$("#toteBadge").text(b.data.items.length),clevertap.event.push("remove_from_tote",{user_id:USER_ID,product_id:c.product_id,size:c.product_size,quantity:c.product_quantity,price:c.listing_price}))});else{a.carts.items.splice(a.carts.items.indexOf(c),1),a.carts.total_listing_price=a.carts.total_listing_price-c.listing_price;var d=e.tote.cart_data;for(i in d)if(d[i].id==c.id)return e.tote.cart_data.splice(i,1),$("#toteBadge").text(e.tote.cart_data.length),!1}},a.closeRemoveSoldoutPopup=function(){$("#confirm_remove_item").removeClass("is_visible")},c.getZapCash=function(){b.get("/zapcart/checkout/").success(function(b){"success"==b.status&&(a.zapcash=b.data.zap_cash,a.checkoutData=b.data)})},a.removeSoldoutItem=function(){for(i in a.itemsToRemove)b.delete("/zapcart/",{params:{item_id:a.itemsToRemove[i]}}).success(function(b){"success"==b.status&&(a.carts=b.data,$(".cart_btn").removeClass("is_hidden"),$(".goto_btn").addClass("is_hidden"),$("#toteBadge").text(b.data.items.length))});$("#sold_out_cart").removeClass("is_visible"),a.itemsToRemove=[]},a.itemsToRemove=[],a.checkout=function(){a.itemsToRemove=[],"True"==ZL?(a.order_id="",setTimeout(function(){b.get("/zapcart/").success(function(b){if("success"==b.status){a.carts=b.data,cart_id=b.data.cart_id;var c=a.carts.items;if(!c.length)return $("#cart").addClass("is_visible"),$("#checkout").removeClass("is_visible"),window.history.pushState("","","#rp_cart"),!1;for(var d in c)c[d].quantity_available<c[d].product_quantity&&a.itemsToRemove.push(c[d].id);if(a.itemsToRemove.length)return $("#cart").addClass("is_visible"),$("#checkout").removeClass("is_visible"),$("#sold_out_cart").addClass("is_visible"),window.history.pushState("","","#rp_cart"),!1;$(".right_panel_inner > div").removeClass("is_visible"),$("#checkout").addClass("is_visible"),$(".right_panel").addClass("is_visible"),window.history.pushState("","","#rp_checkout"),$("#order_review h6.title").click(),a.getZapCash(),a.my_addresses(),cleverTapCheckout(1)}})})):setTimeout(function(){a.$emit("setLoginPurpose","continue with the purchase"),$(".right_panel_inner > div").removeClass("is_visible"),$("#login_options").addClass("is_visible"),$(".right_panel").addClass("is_visible")})},a.backToCheckout=function(){a.order_id?swal({title:"Cancel transaction?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",cancelButtonText:"No",closeOnConfirm:!0,closeOnCancel:!0},function(c){c&&(b.put("/order/juspay_order",{order_id:a.order_id}),$("#checkout").addClass("is_visible"),$("#juspay_options").removeClass("is_visible"))}):($("#cart").addClass("is_visible"),$("#checkout").removeClass("is_visible"),window.history.pushState("","","#rp_cart"))},a.enableCOD=function(){a.checkoutData.cod&&(a.cod=!0)},a.enableJuspay=function(){a.cod=!1};var p=window.location.href;if("True"==ZL&&p.indexOf("/#")>-1){var q=p.split("#")[p.split("#").length-1],r=q.replace("rp_","");try{a[r](),$(".right_panel").addClass("is_visible"),$("#"+r).addClass("is_visible")}catch(a){var s=r.split("/");"product"!=s[1]&&"profile"!=s[1]||void 0==s[2]?"feeds"==s[1]||"discover"==s[1]||"sell"==s[1]?window.location.href="/"+s[1]:console.log("url mismatch"):window.location.href=s[1]+"/"+s[2]}}else if("False"==ZL&&p.indexOf("/#")>-1){var r=p.split("/#rp_")[1];"search"==r?($("#search").addClass("is_visible"),setTimeout(function(){$("#search_box").focus()})):"cart"==r?($("#cart").addClass("is_visible"),a.cart()):(window.history.pushState("","","#rp_login_options"),$("#login_options").addClass("is_visible")),$(".right_panel").addClass("is_visible")}a.logout=function(){$.get("/account/logout/",function(a){clevertap.logout(),location.reload()})},a.signin=function(){a.loginError={},b({method:"POST",url:"/account/login/",data:{email:a.email,password:a.pwd,logged_device:"website",logged_from:"zapyle"}}).then(function(c){if("success"==c.data.status)window.history.pushState("","",window.location.href.split("#")[0]+"#rp_my_profile"),location.reload();else{var d=c.data.detail;"string"==typeof d?a.loginError.email=d:("email"in d&&(a.loginError.email=d.email[0]),"password"in d&&(a.loginError.password=d.password[0]))}})},a.signup=function(){a.errors={},b({method:"POST",url:"/account/signup/",data:{zap_username:a.zapusername,email:a.email,password:a.password,confirm_password:a.password,phone_number:a.phone,first_name:a.name,logged_device:"website"}}).then(function(c){if("success"==c.data.status)window.history.pushState("","",window.location.href.split("#")[0]+"#rp_my_profile"),location.reload();else{var d=c.data.detail;"zap_username"in d&&(a.errors.username=d.zap_username[0]),"email"in d&&(a.errors.email=d.email[0]),"password"in d&&(a.errors.pwd=d.password[0]),"confirm_password"in d&&(a.errors.cpwd=d.confirm_password[0]),"first_name"in d&&(a.errors.fname=d.first_name[0]),"phone_number"in d&&(d.phone_number.phone_number?a.errors.phone=d.phone_number.phone_number:a.errors.phone=d.phone_number[0])}})},c.setZapCash=function(b){b&&($(".check_box").addClass("is_selected"),a.zapcash_used=b,a.zapcash-=b)},a.zapcash=0,a.zapcash_used=0,$(".check_box").click(function(){$(this).hasClass("is_selected")?(a.zapcash=a.zapcash_used,a.zapcash_used=0):a.zapcash>a.carts.total_listing_price?(a.zapcash_used=a.carts.total_listing_price,a.zapcash-=a.carts.total_listing_price):(a.zapcash_used=a.zapcash,a.zapcash=0),a.$apply()}),$("body").on("click",".star_item",function(){a.rating=parseInt($(this).data("rating")),a.$apply(),setTimeout(function(){b.post("/order/rate_order",{order_id:a.currentOrder,rating:a.rating}).success(function(a){$(".rating_response").removeClass("is_hiddden")})})}),$(".close_right_panel").click(function(){$(".right_panel").removeClass("is_visible"),window.history.pushState("","",window.location.href.split("#")[0])}),a.citrusClientErrMsg=function(){$("#cnf_btn").text("Proceed to Payment"),a.loader=!1,u=!0,b.put("/payment/confirmorder/website/",{TxId:a.citrus_var.merchantTxnId})},$("body").on("click","#delivery_address_cta",function(){return a.addrs?$(".address_item").hasClass("selected")?($("#checkout").attr("class","is_visible step_3"),closeAccordion($(".step.open h6.title")),$(".address").addClass("is_visible"),openAccordion($("#payment_options h6.title")),void cleverTapCheckout(3)):(Materialize.toast("Select the delivery address",3e3),!1):(Materialize.toast("Add Delivery Address",3e3),!1)}),$("body").on("click",".address_item",function(){$(".address").text($(this).find(".name .namee").text()+" - "+$(this).find(".name .phone").text())}),$("body").on("click",".saved_card_item",function(){$(".saved_cards_list").find(".saved_card_item input").removeAttr("checked"),$(this).find("input").first().prop("checked",!0),$("#cvv").addClass("is_visible"),$("#cvv input").val("").focus(),$(".PayFromWallet").prop("id","citrusWalletCardPayButton")}),$("#cvv .close_btn").click(function(){$(".saved_card_item").removeClass("selected")}),$("body").on("click",".rp_trigger.icon-heart_empty",function(){a.$emit("setLoginPurpose","see your loves list")}),c.juspayOrder=function(c){return!!$(".address_item").hasClass("selected")&&void(a.order_id?b.put("/order/juspay_order",{order_id:a.order_id}).success(function(a){"success"==a.status&&t(c)}):t(c))},a.codOrder=function(){return $("#cod_modal").openModal(),!1},$("#codConfirm").click(function(){a.juspayOrder(!0)}),$("body").on("click","#payment_options h6.title",function(){return $(".address_item").hasClass("selected")?(a.juspayOrder(),$("#checkout").attr("class","is_visible step_3"),closeAccordion($(".step.open h6.title")),openAccordion($("#payment_options h6.title")),cleverTapCheckout(3),void 0):(Materialize.toast("Please select the delivery address",3e3),!1)});var u=!0;a.confirmOrder=function(){if(!u)return!1;if(console.log(new Date),console.log("---------------"),!a.addrs)return Materialize.toast("Please add address",3e3),!1;if(!$(".address_item").hasClass("selected"))return Materialize.toast("Please select the delivery address",3e3),closeAccordion($(".step.open h6.title")),openAccordion($("#delivery_address h6.title")),!1;if($(".saved_cards_list > li").hasClass("selected")){if(!$("#cvv input").val())return $("#cvv").addClass("is_visible"),$("#cvv input").val("").focus(),!1}else if(a.netBankSelected);else if($("#credit").hasClass("selected"));else if($("#debit").hasClass("selected"));else if(!$("#cod").hasClass("selected"))return Materialize.toast("Select a payment option.",3e3),!1;a.confirm_email_num()},a.confirm_email_num=function(){b({method:"GET",url:"/user/get_email_and_num/"}).then(function(c){return"success"==c.data.status?(a.confirm_email=c.data.data.user_detail.email,a.confirm_number=c.data.data.user_detail.phone_number,a.confirm_zap_username=c.data.data.user_detail.zap_username,a.phone_number_verified=c.data.data.user_detail.phone_number_verified,a.confirm_email&&a.confirm_zap_username?0==a.phone_number_verified?(Materialize.toast("error phone",3e3),a.phone_model=!0,a.error_msg_phone={},!1):(a.postData(),!1):(Materialize.toast("error zapusername or phone",3e3),a.modal_phone_pop=!0,a.errors_confirm={},!1)):void Materialize.toast("Sorry, please try later.",3e3)},function(b){})},a.postData=function(){if($("#credit").hasClass("selected")){if(!a.check_card_fields())return Materialize.toast("Please enter card number, cvv, expiry.",3e3),!1;$("#citrusCardType").val("debit")}else if($("#debit").hasClass("selected")){if(!a.check_card_fields())return Materialize.toast("Please fill all the fields in card.",3e3),!1;$("#citrusCardType").val("credit")}return $("#cod").hasClass("selected")?($("#cod_modal").openModal(),!1):void a.postDataApi()},a.loader=!1,a.card={},a.check_card_fields=function(){return!!(a.card.cardNumber&&a.card.name&&a.card.month&&a.card.year&&a.card.cvv)},c.overlay=function(c){b.get("/notif/overlay/"+c).success(function(b){"success"==b.status&&(a.overlayData=b.data,setTimeout(function(){$(".automated.overlay").addClass("is_visible")},b.data.delay))})},c.$on("setLoginPurpose",function(b,c){a.loginPurpose=c,a.$$phase||a.$apply()}),a.loginPurpose="",a.admire=function(b){"True"==ZL?(b.admired?f.postadmire(b.user_id,"unadmire"):f.postadmire(b.user_id,"admire"),b.admired=!b.admired):(a.$emit("setLoginPurpose","admire a user"),$(".right_panel_inner > div").removeClass("is_visible"),$($(".login_label").attr("data-activates")).addClass("is_visible"),$(".right_panel").addClass("is_visible"))},$(".right_panel > .glass, .right_panel_inner > .close_btn").click(function(){var c=window.location.href;c.indexOf("rp_checkout")==-1&&c.indexOf("/order/")==-1||!a.order_id?window.history.pushState("","",c.split("/#")[0]):swal({title:"Cancel transaction?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",cancelButtonText:"No",closeOnConfirm:!0,closeOnCancel:!0},function(d){d?(window.history.pushState("","",c.split("/#")[0]),b.put("/order/juspay_order",{order_id:a.order_id}),a.order_id=""):$(".right_panel").addClass("is_visible")})}),a.insta_login=function(){window.location.href="/account/instagram/"},a.errors={},a.onboardingStep=2,a.submitUsername=function(){b({method:"POST",url:"/onboarding/1/",data:a.user1}).then(function(d){if("success"==d.data.status){ZL="True",USER_NAME=a.user1.zap_username,a.user.zap_username=USER_NAME,$(".login_label").html(USER_NAME);var e="F";e=$("#onboarding1").hasClass("is_selected")?"F":"M",b.put("/user/myinfo/",{gender:e}),a.onboardingStep=2,$("#my_interests").addClass("is_visible"),$("#my_profile").removeClass("is_visible"),a.my_interests()}else a.errors=d.data.detail})},a.submitBTags=function(){$("#my_interests").removeClass("is_visible"),$("#my_brands").addClass("is_visible"),a.onboardingStep=3,a.my_brands()},a.submitBrands=function(){$("#my_brands").removeClass("is_visible"),$("#my_sizes").addClass("is_visible"),a.onboardingStep=4,a.my_sizes()},a.checkUsername=function(){b({method:"POST",url:"/user/check_username/",data:{zap_username:a.user1.zap_username}}).then(function(c){"error"==c.data.status?a.errors=c.data.detail:a.errors={}})},a.addCoupon=function(){"True"==ZL&&"None"!=USER_NAME?$("#add_coupon").addClass("is_visible"):(a.$emit("setLoginPurpose","apply a coupon and make a purchase"),$(".right_panel_inner > div").removeClass("is_visible"),$($(".login_label").attr("data-activates")).addClass("is_visible"),$(".right_panel").addClass("is_visible"))},a.applyCoupon=function(d){if(d){var e={carts:[]};for(i in a.carts.items)e.carts.push(a.carts.items[i].id);b.post("/offer/apply/"+d,e).success(function(a,b,d,e){"success"==a.status?($("#add_coupon").removeClass("is_visible"),c.cart()):Materialize.toast(a.detail,3e3)})}},a.getCredits=function(c){c&&b.post("/coupon/promo/",{code:c}).success(function(b){"success"==b.status?(Materialize.toast(b.data.message,3e3),a.user.wallet+=b.data.amount,$("#promocode").removeClass("is_visible"),a.promocode=""):(Materialize.toast(b.detail,3e3),$("#promocode input").focus())})},a.initLoginPupose=function(){a.loginPurpose=!1},window.userInteractionTimeout=null,window.userInteractionInHTMLArea=!1,window.onBrowserHistoryButtonClicked=null,$(document).mousedown(function(){clearTimeout(window.userInteractionTimeout),window.userInteractionInHTMLArea=!0,window.userInteractionTimeout=setTimeout(function(){window.userInteractionInHTMLArea=!1},500)}),$(document).keydown(function(){clearTimeout(window.userInteractionTimeout),window.userInteractionInHTMLArea=!0,window.userInteractionTimeout=setTimeout(function(){window.userInteractionInHTMLArea=!1},500)}),window.history&&window.history.pushState&&$(window).on("popstate",function(){if(!window.userInteractionInHTMLArea){var b=window.location.href.split("/#")[1];if(b){var c=b.replace("rp_","");try{a[c](),$(".right_panel").addClass("is_visible"),$("#"+c).addClass("is_visible")}catch(a){var d=c.split("/");"product"!=d[1]&&"profile"!=d[1]||void 0==d[2]?"feeds"==d[1]||"discover"==d[1]||"sell"==d[1]?window.location.href="/"+d[1]:console.log("url mismatch"):window.location.href=d[1]+"/"+d[2]}}else $(".right_panel").removeClass("is_visible")}window.onBrowserHistoryButtonClicked&&window.onBrowserHistoryButtonClicked()}),a.wlError="",a.offer_500=!0,setTimeout(function(){a.offer_500=getCookie("offer_500"),a.$$phase||a.$apply()},4e3),a.get500=function(){return a.emailId?(a.wlError="",a.wlErrorEmail="",void b.post("/user/website_lead",{email:a.emailId}).success(function(b){"success"==b.status?(document.cookie="offer_500=true; expires=Thu, 18 Dec 2016 12:00:00 UTC; path=/",a.wlSuccess=!0,setTimeout(function(){a.offer_500=!0,a.$$phase||a.$apply()},1e4)):"invalid email"==b.detail?a.wlErrorEmail="invalid email":(a.wlError=b.detail,document.cookie="offer_500=true; expires=Thu, 18 Dec 2016 12:00:00 UTC; path=/",setTimeout(function(){a.offer_500=!0,$("#bio_ep").css("display","none"),a.$$phase||a.$apply()},1e4))})):(a.wlErrorEmail="invalid email",!1)},a.ZL=ZL,a.hideWLOverlay=function(){$("#bio_ep").css("display","none"),$("#fashion_is_unfair").removeClass("is_visible"),document.cookie="offer_500=true; expires=Thu, 18 Dec 2016 12:00:00 UTC; path=/",a.offer_500=!0,a.$$phase||a.$apply()},a.showReason=function(){$("#return_reason").addClass("is_visible")},a.returnOrder=function(c){$(".selectable").hasClass("selected")?($("#returnLoader").addClass("is_visible"),b.post("/user/myorders",{order_id:a.order.id,reason:$(".selectable.selected").data("reason")}).success(function(a){$("#returnLoader").removeClass("is_visible"),"success"==a.status?($("#return_reason").removeClass("is_visible"),c.steps.push({title:"Return Requested"},{title:"Return to be confirmed"},{title:"Product yet to be returned"}),c.current_title="Return Requested",c.description="Return Requested for Approval",c.current_step++,c.cta=!1):Materialize.toast(a.detail,3e3)})):Materialize.toast("select a return reason.",3e3)}}]);var cart_id="";